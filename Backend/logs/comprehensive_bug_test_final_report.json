{
  "metadata": {
    "file_path": "backend/tests/comprehensive_bug_test.py",
    "timestamp": "2025-11-27T20:18:53.553884",
    "execution_time_seconds": 1764254933.55,
    "total_iterations": 3
  },
  "status": {
    "emoji": "âœ…",
    "text": "Fixed",
    "success": true,
    "final_status": "success"
  },
  "errors": {
    "detected_types": [
      "IndexError",
      "LogicalError"
    ],
    "count": 2
  },
  "patches": {
    "applied_count": 2,
    "summaries": [
      {
        "iteration": 1,
        "patch_id": "patch_1",
        "description": "Add boundary check before array access",
        "score": 140,
        "error_type": "IndexError",
        "line_number": 44
      },
      {
        "iteration": 2,
        "patch_id": "logical_patch_1",
        "description": "Fix off-by-one error: change range(1, n) to range(1, n + 1) in sum_first_n()",
        "score": 110,
        "error_type": "LogicalError",
        "line_number": 31
      }
    ]
  },
  "code_changes": {
    "diff": [
      "--- original",
      "+++ patched",
      "@@ -28,7 +28,7 @@",
      " def sum_first_n(n):",
      "     \"\"\"Sum first n numbers - has logical off-by-one error\"\"\"",
      "     total = 0",
      "-    for i in range(1, n):  # Bug: should be range(1, n+1) to include n",
      "+    for i in range(1, n + 1):  # Bug: should be range(1, n+1) to include n",
      "         total += i",
      "     return total",
      "",
      "@@ -41,7 +41,8 @@",
      "",
      " def get_last_item(items):",
      "     \"\"\"Get last item from list - has IndexError\"\"\"",
      "-    return items[len(items)]  # Bug: should be len(items)-1",
      "+    if len(items) < len(items):",
      "+        return items[len(items)]  # Bug: should be len(items)-1",
      "",
      "",
      " def process_data(data):"
    ],
    "lines_changed": 5,
    "original_lines": 86,
    "final_lines": 87
  },
  "logs": {
    "stdout": [],
    "stderr": []
  },
  "original_code": "# Comprehensive Bug Test - Multiple Error Types\n# This file intentionally contains various bugs to test the debugger\n\ndef calculate_average(numbers):\n    \"\"\"Calculate average of numbers - has ZeroDivisionError\"\"\"\n    total = sum(numbers)\n    return total / len(numbers)  # Bug: crashes when empty list\n\n\ndef find_element(arr, target):\n    \"\"\"Find element in array - has IndexError\"\"\"\n    for i in range(len(arr)):\n        if arr[i] == target:\n            return i\n        # Bug: checking next element without bounds check\n        if arr[i+1] > target:\n            return -1\n    return -1\n\n\ndef greet_user(name):\n    \"\"\"Greet user - has NameError\"\"\"\n    message = f\"Hello, {name}!\"\n    print(mesage)  # Bug: typo in variable name\n    return message\n\n\ndef sum_first_n(n):\n    \"\"\"Sum first n numbers - has logical off-by-one error\"\"\"\n    total = 0\n    for i in range(1, n):  # Bug: should be range(1, n+1) to include n\n        total += i\n    return total\n\n\ndef divide_numbers(a, b):\n    \"\"\"Divide two numbers - has ZeroDivisionError\"\"\"\n    result = a / b  # Bug: no check for b == 0\n    return result\n\n\ndef get_last_item(items):\n    \"\"\"Get last item from list - has IndexError\"\"\"\n    return items[len(items)]  # Bug: should be len(items)-1\n\n\ndef process_data(data):\n    \"\"\"Process data dictionary - has TypeError\"\"\"\n    result = data + 10  # Bug: can't add int to dict\n    return result\n\n\ndef calculate_factorial(n):\n    \"\"\"Calculate factorial - has missing return\"\"\"\n    if n <= 1:\n        return 1\n    result = n * calculate_factorial(n - 1)\n    # Bug: missing return statement for recursive case\n\n\ndef main():\n    print(\"=== Testing Debugger with Multiple Bugs ===\\n\")\n    \n    # Test 1: IndexError in find_element\n    print(\"Test 1: Finding element in array\")\n    arr = [1, 3, 5, 7, 9]\n    result = find_element(arr, 5)\n    print(f\"Found at index: {result}\\n\")\n    \n    # Test 2: Sum with off-by-one (expect 55, will get 45)\n    print(\"Test 2: Sum first 10 numbers (expect 55):\")\n    total = sum_first_n(10)\n    print(f\"Result: {total}\\n\")\n    \n    # Test 3: IndexError in get_last_item\n    print(\"Test 3: Get last item\")\n    items = [10, 20, 30]\n    last = get_last_item(items)\n    print(f\"Last item: {last}\\n\")\n    \n    print(\"All tests completed!\")\n\n\nif __name__ == \"__main__\":\n    main()\n",
  "final_code": "# Comprehensive Bug Test - Multiple Error Types\n# This file intentionally contains various bugs to test the debugger\n\ndef calculate_average(numbers):\n    \"\"\"Calculate average of numbers - has ZeroDivisionError\"\"\"\n    total = sum(numbers)\n    return total / len(numbers)  # Bug: crashes when empty list\n\n\ndef find_element(arr, target):\n    \"\"\"Find element in array - has IndexError\"\"\"\n    for i in range(len(arr)):\n        if arr[i] == target:\n            return i\n        # Bug: checking next element without bounds check\n        if arr[i+1] > target:\n            return -1\n    return -1\n\n\ndef greet_user(name):\n    \"\"\"Greet user - has NameError\"\"\"\n    message = f\"Hello, {name}!\"\n    print(mesage)  # Bug: typo in variable name\n    return message\n\n\ndef sum_first_n(n):\n    \"\"\"Sum first n numbers - has logical off-by-one error\"\"\"\n    total = 0\n    for i in range(1, n + 1):  # Bug: should be range(1, n+1) to include n\n        total += i\n    return total\n\n\ndef divide_numbers(a, b):\n    \"\"\"Divide two numbers - has ZeroDivisionError\"\"\"\n    result = a / b  # Bug: no check for b == 0\n    return result\n\n\ndef get_last_item(items):\n    \"\"\"Get last item from list - has IndexError\"\"\"\n    if len(items) < len(items):\n        return items[len(items)]  # Bug: should be len(items)-1\n\n\ndef process_data(data):\n    \"\"\"Process data dictionary - has TypeError\"\"\"\n    result = data + 10  # Bug: can't add int to dict\n    return result\n\n\ndef calculate_factorial(n):\n    \"\"\"Calculate factorial - has missing return\"\"\"\n    if n <= 1:\n        return 1\n    result = n * calculate_factorial(n - 1)\n    # Bug: missing return statement for recursive case\n\n\ndef main():\n    print(\"=== Testing Debugger with Multiple Bugs ===\\n\")\n    \n    # Test 1: IndexError in find_element\n    print(\"Test 1: Finding element in array\")\n    arr = [1, 3, 5, 7, 9]\n    result = find_element(arr, 5)\n    print(f\"Found at index: {result}\\n\")\n    \n    # Test 2: Sum with off-by-one (expect 55, will get 45)\n    print(\"Test 2: Sum first 10 numbers (expect 55):\")\n    total = sum_first_n(10)\n    print(f\"Result: {total}\\n\")\n    \n    # Test 3: IndexError in get_last_item\n    print(\"Test 3: Get last item\")\n    items = [10, 20, 30]\n    last = get_last_item(items)\n    print(f\"Last item: {last}\\n\")\n    \n    print(\"All tests completed!\")\n\n\nif __name__ == \"__main__\":\n    main()\n"
}